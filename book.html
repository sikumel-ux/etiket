<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; padding: 20px; }
    .form-container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
    .header-title { text-align: center; margin-bottom: 25px; color: #0d6efd; }
  </style>
</head>
<body>

<div class="container">
  <div class="form-container">
    <h2 class="header-title">Input Data Penumpang</h2>
    <form id="inputForm" onsubmit="handleFormSubmit(this)">
      
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Tanggal</label>
          <input type="date" name="tanggal" class="form-control" required>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Jam</label>
          <input type="text" name="jam" class="form-control" placeholder="Contoh: 19:00" required>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">Nama Penumpang</label>
        <input type="text" name="nama" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">No. HP</label>
        <input type="tel" name="no_hp" class="form-control" required>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Armada</label>
          <input type="text" name="armada" class="form-control" placeholder="Nama Bus" required>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Tujuan</label>
          <input type="text" name="tujuan" class="form-control" required>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">No. Kursi</label>
          <input type="text" name="no_kursi" class="form-control" required>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Harga</label>
          <input type="number" name="harga" class="form-control" required>
        </div>
      </div>

      <button type="submit" id="btnSubmit" class="btn btn-primary w-100 mt-3">Simpan Data</button>
    </form>
    <div id="output" class="mt-3 text-center"></div>
  </div>
</div>

<script>
  function handleFormSubmit(formObject) {
    document.getElementById('btnSubmit').disabled = true;
    document.getElementById('btnSubmit').innerText = "Sedang Menyimpan...";
    document.getElementById('output').innerHTML = "";

    google.script.run
      .withSuccessHandler(function(msg) {
        document.getElementById('output').innerHTML = `<div class="alert alert-success">${msg}</div>`;
        document.getElementById('inputForm').reset();
        document.getElementById('btnSubmit').disabled = false;
        document.getElementById('btnSubmit').innerText = "Simpan Data";
      })
      .processForm(formObject);
  }
</script>

</body>
</html>
