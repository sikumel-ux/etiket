<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manifest Penumpang | Mahika Trans</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f4f7f6; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        h2 { text-align: center; color: #0f4c81; }
        .card { background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 5px solid #1b9aaa; }
        .tgl-badge { background: #0f4c81; color: white; padding: 4px 8px; border-radius: 5px; font-size: 12px; }
        .info-bus { font-weight: bold; color: #333; margin: 5px 0; }
        .detail { font-size: 14px; color: #666; }
        .loading { text-align: center; padding: 20px; }
        .nav-bottom { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: space-around; padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .nav-bottom a { color: #0f4c81; font-size: 20px; text-decoration: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>Daftar Manifes</h2>
    <div id="loading" class="loading">Memuat data keberangkatan...</div>
    <div id="manifestList"></div>
    <div style="height: 80px;"></div> </div>

<div class="nav-bottom">
    <a href="index.html"><i class="fas fa-ticket"></i></a>
    <a href="manifest.html" style="color: #1b9aaa;"><i class="fas fa-list"></i></a>
    <a href="#" onclick="location.reload()"><i class="fas fa-sync"></i></a>
</div>

<script>
    const API_URL = "URL_WEB_APP_GOOGLE_SCRIPT_KAMU?action=getManifest";

    async function loadManifest() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();
            const listDiv = document.getElementById("manifestList");
            document.getElementById("loading").style.display = "none";

            if (data.length === 0) {
                listDiv.innerHTML = "<p style='text-align:center'>Tidak ada jadwal keberangkatan terdekat.</p>";
                return;
            }

            listDiv.innerHTML = data.map(item => {
                const d = new Date(item.tanggal);
                const tglFormat = d.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
                
                return `
                    <div class="card">
                        <span class="tgl-badge">${tglFormat} - ${item.jam}</span>
                        <div class="info-bus">${item.armada}</div>
                        <div class="detail">
                            <i class="fas fa-user"></i> ${item.nama} <br>
                            <i class="fas fa-map-marker-alt"></i> Tujuan: ${item.tujuan}
                        </div>
                    </div>
                `;
            }).join('');
        } catch (err) {
            document.getElementById("loading").innerText = "Gagal memuat data.";
            console.error(err);
        }
    }

    loadManifest();
</script>
</body>
</html>
